<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="A simple link shortener, written with love">
        <title>Dr. Ver</title>
        <style>
            * {
                font-family: Arial, Helvetica, sans-serif;
                font-weight: 300;
                text-align: center;
                box-sizing: border-box;
            }
            body {
                width: 100%;
                height: 100%;
                padding: 0;
                margin: 0;
                background-color: rgb({{ r }}, {{ g }}, {{ b }});
            }
            #container {
                width: 100%;
                height: 100%;
            }
            button {
                padding: 8px 16px;
                border: 1.4px solid #bbbbbb;
                border-radius: 8px;
                background-color: #f1f1f1;
            }
            button:hover {
                background-color: #bbbbbb;
            }
            .git {
                font-style: italic;
            }
        </style>
    </head>
    
    <body>
        <div id="container">
            <h1>Let's Make a Color!</h1>

            <p>Current Color: <span id="color">rgb({{ r }}, {{ g }}, {{ b }})</span></p>
            <button onclick="submit('red')">Red</button>
            <button onclick="submit('green')">Green</button>
            <button onclick="submit('blue')">Blue</button>

            <script>
                function submit(color) {
                    fetch(`/api/v1/${color}`, {
                        method: "POST"
                    })                    
                    .then(response => response.json()) 
                    .then(json => {
                        t = json.red + json.green + json.blue;
                        rp = Math.floor(json.red * 100 / t)
                        gp = Math.floor(json.green * 100 / t)
                        bp = Math.floor(json.blue * 100 / t)
                        document.getElementById('color').innerText = `rgb(${rp}%, ${gp}%, ${bp}%)`;
                        document.getElementsByTagName('body')[0].style.backgroundColor = `rgb(${rp}%, ${gp}%, ${bp}%)`;
                    })
                    .catch(err => console.log(err));
                }
            </script>

            {% if commit_hash %}
            <div class="git">
                <p>
                <a href="https://github.com/galenguyer/color/tree/{{ commit_hash }}">Check out this project on GitHub ({{ commit_hash }})</a>
                </p>
            </div>
            {% endif %}
        </div>
    </body>
</html>